+function(o){"use strict";var e=function(e){var a,t=this,n=this.defaults;e=e||{};for(var r in n)"undefined"==typeof e[r]&&(e[r]=n[r]);t.params=e;var s=t.params.navbarTemplate||'<header class="bar bar-nav"><a class="icon icon-left pull-left photo-browser-close-link'+("popup"===t.params.type?" close-popup":"")+'"></a><h1 class="title"><div class="center sliding"><span class="photo-browser-current"></span> <span class="photo-browser-of">'+t.params.ofText+'</span> <span class="photo-browser-total"></span></div></h1></header>',i=t.params.toolbarTemplate||'<nav class="bar bar-tab"><a class="tab-item photo-browser-prev" href="#"><i class="icon icon-prev"></i></a><a class="tab-item photo-browser-next" href="#"><i class="icon icon-next"></i></a></nav>',p=t.params.template||'<div class="photo-browser photo-browser-'+t.params.theme+'">{{navbar}}{{toolbar}}<div data-page="photo-browser-slides" class="content">{{captions}}<div class="photo-browser-swiper-container swiper-container"><div class="photo-browser-swiper-wrapper swiper-wrapper">{{photos}}</div></div></div></div>',l=t.params.lazyLoading?t.params.photoLazyTemplate||'<div class="photo-browser-slide photo-browser-slide-lazy swiper-slide"><div class="preloader'+("dark"===t.params.theme?" preloader-white":"")+'"></div><span class="photo-browser-zoom-container"><img data-src="{{url}}" class="swiper-lazy"></span></div>':t.params.photoTemplate||'<div class="photo-browser-slide swiper-slide"><span class="photo-browser-zoom-container"><img src="{{url}}"></span></div>',d=t.params.captionsTheme||t.params.theme,c=t.params.captionsTemplate||'<div class="photo-browser-captions photo-browser-captions-'+d+'">{{captions}}</div>',m=t.params.captionTemplate||'<div class="photo-browser-caption" data-caption-index="{{captionIndex}}">{{caption}}</div>',h=t.params.objectTemplate||'<div class="photo-browser-slide photo-browser-object-slide swiper-slide">{{html}}</div>',w="",v="";for(a=0;a<t.params.photos.length;a++){var u=t.params.photos[a],g="";"string"==typeof u||u instanceof String?g=u.indexOf("<")>=0||u.indexOf(">")>=0?h.replace(/{{html}}/g,u):l.replace(/{{url}}/g,u):"object"==typeof u&&(u.hasOwnProperty("html")&&u.html.length>0?g=h.replace(/{{html}}/g,u.html):u.hasOwnProperty("url")&&u.url.length>0&&(g=l.replace(/{{url}}/g,u.url)),u.hasOwnProperty("caption")&&u.caption.length>0?v+=m.replace(/{{caption}}/g,u.caption).replace(/{{captionIndex}}/g,a):g=g.replace(/{{caption}}/g,"")),w+=g}var f=p.replace("{{navbar}}",t.params.navbar?s:"").replace("{{noNavbar}}",t.params.navbar?"":"no-navbar").replace("{{photos}}",w).replace("{{captions}}",c.replace(/{{captions}}/g,v)).replace("{{toolbar}}",t.params.toolbar?i:"");t.activeIndex=t.params.initialSlide,t.openIndex=t.activeIndex,t.opened=!1,t.open=function(e){return"undefined"==typeof e&&(e=t.activeIndex),e=parseInt(e,10),t.opened&&t.swiper?void t.swiper.slideTo(e):(t.opened=!0,t.openIndex=e,"standalone"===t.params.type&&o(t.params.container).append(f),"popup"===t.params.type&&(t.popup=o.popup('<div class="popup photo-browser-popup">'+f+"</div>"),o(t.popup).on("closed",t.onPopupClose)),"page"===t.params.type?(o(document).on("pageBeforeInit",t.onPageBeforeInit),o(document).on("pageBeforeRemove",t.onPageBeforeRemove),t.params.view||(t.params.view=o.mainView),void t.params.view.loadContent(f)):(t.layout(t.openIndex),void(t.params.onOpen&&t.params.onOpen(t))))},t.close=function(){t.opened=!1,t.swiperContainer&&0!==t.swiperContainer.length&&(t.params.onClose&&t.params.onClose(t),t.attachEvents(!0),"standalone"===t.params.type&&t.container.removeClass("photo-browser-in").addClass("photo-browser-out").animationEnd(function(){t.container.remove()}),t.swiper.destroy(),t.swiper=t.swiperContainer=t.swiperWrapper=t.slides=b=x=y=void 0)},t.onPopupClose=function(){t.close(),o(t.popup).off("pageBeforeInit",t.onPopupClose)},t.onPageBeforeInit=function(e){"photo-browser-slides"===e.detail.page.name&&t.layout(t.openIndex),o(document).off("pageBeforeInit",t.onPageBeforeInit)},t.onPageBeforeRemove=function(e){"photo-browser-slides"===e.detail.page.name&&t.close(),o(document).off("pageBeforeRemove",t.onPageBeforeRemove)},t.onSliderTransitionStart=function(e){t.activeIndex=e.activeIndex;var a=e.activeIndex+1,n=e.slides.length;if(t.params.loop&&(n-=2,a-=e.loopedSlides,1>a&&(a=n+a),a>n&&(a-=n)),t.container.find(".photo-browser-current").text(a),t.container.find(".photo-browser-total").text(n),o(".photo-browser-prev, .photo-browser-next").removeClass("photo-browser-link-inactive"),e.isBeginning&&!t.params.loop&&o(".photo-browser-prev").addClass("photo-browser-link-inactive"),e.isEnd&&!t.params.loop&&o(".photo-browser-next").addClass("photo-browser-link-inactive"),t.captions.length>0){t.captionsContainer.find(".photo-browser-caption-active").removeClass("photo-browser-caption-active");var r=t.params.loop?e.slides.eq(e.activeIndex).attr("data-swiper-slide-index"):t.activeIndex;t.captionsContainer.find('[data-caption-index="'+r+'"]').addClass("photo-browser-caption-active")}var s=e.slides.eq(e.previousIndex).find("video");s.length>0&&"pause"in s[0]&&s[0].pause(),t.params.onSlideChangeStart&&t.params.onSlideChangeStart(e)},t.onSliderTransitionEnd=function(o){t.params.zoom&&b&&o.previousIndex!==o.activeIndex&&(x.transform("translate3d(0,0,0) scale(1)"),y.transform("translate3d(0,0,0)"),b=x=y=void 0,C=T=1),t.params.onSlideChangeEnd&&t.params.onSlideChangeEnd(o)},t.layout=function(e){"page"===t.params.type?t.container=o(".photo-browser-swiper-container").parents(".view"):t.container=o(".photo-browser"),"standalone"===t.params.type&&t.container.addClass("photo-browser-in"),t.swiperContainer=t.container.find(".photo-browser-swiper-container"),t.swiperWrapper=t.container.find(".photo-browser-swiper-wrapper"),t.slides=t.container.find(".photo-browser-slide"),t.captionsContainer=t.container.find(".photo-browser-captions"),t.captions=t.container.find(".photo-browser-caption");var a={nextButton:t.params.nextButton||".photo-browser-next",prevButton:t.params.prevButton||".photo-browser-prev",indexButton:t.params.indexButton,initialSlide:e,spaceBetween:t.params.spaceBetween,speed:t.params.speed,loop:t.params.loop,lazyLoading:t.params.lazyLoading,lazyLoadingInPrevNext:t.params.lazyLoadingInPrevNext,lazyLoadingOnTransitionStart:t.params.lazyLoadingOnTransitionStart,preloadImages:t.params.lazyLoading?!1:!0,onTap:function(o,e){t.params.onTap&&t.params.onTap(o,e)},onClick:function(o,e){t.params.exposition&&t.toggleExposition(),t.params.onClick&&t.params.onClick(o,e)},onDoubleTap:function(e,a){t.toggleZoom(o(a.target).parents(".photo-browser-slide")),t.params.onDoubleTap&&t.params.onDoubleTap(e,a)},onTransitionStart:function(o){t.onSliderTransitionStart(o)},onTransitionEnd:function(o){t.onSliderTransitionEnd(o)},onLazyImageLoad:function(o,e,a){t.params.onLazyImageLoad&&t.params.onLazyImageLoad(t,e,a)},onLazyImageReady:function(e,a,n){o(a).removeClass("photo-browser-slide-lazy"),t.params.onLazyImageReady&&t.params.onLazyImageReady(t,a,n)}};t.params.swipeToClose&&"page"!==t.params.type&&(a.onTouchStart=t.swipeCloseTouchStart,a.onTouchMoveOpposite=t.swipeCloseTouchMove,a.onTouchEnd=t.swipeCloseTouchEnd),t.swiper=o.swiper(t.swiperContainer,a),0===e&&t.onSliderTransitionStart(t.swiper),t.attachEvents()},t.attachEvents=function(o){var e=o?"off":"on";if(t.params.zoom){var a=t.params.loop?t.swiper.slides:t.slides;a[e]("gesturestart",t.onSlideGestureStart),a[e]("gesturechange",t.onSlideGestureChange),a[e]("gestureend",t.onSlideGestureEnd),a[e]("touchstart",t.onSlideTouchStart),a[e]("touchmove",t.onSlideTouchMove),a[e]("touchend",t.onSlideTouchEnd)}t.container.find(".photo-browser-close-link")[e]("click",t.close)},t.exposed=!1,t.toggleExposition=function(){t.container&&t.container.toggleClass("photo-browser-exposed"),t.params.expositionHideCaptions&&t.captionsContainer.toggleClass("photo-browser-captions-exposed"),t.exposed=!t.exposed},t.enableExposition=function(){t.container&&t.container.addClass("photo-browser-exposed"),t.params.expositionHideCaptions&&t.captionsContainer.addClass("photo-browser-captions-exposed"),t.exposed=!0},t.disableExposition=function(){t.container&&t.container.removeClass("photo-browser-exposed"),t.params.expositionHideCaptions&&t.captionsContainer.removeClass("photo-browser-captions-exposed"),t.exposed=!1};var b,x,y,C=1,T=1,S=!1;t.onSlideGestureStart=function(){return b||(b=o(this),x=b.find("img, svg, canvas"),y=x.parent(".photo-browser-zoom-container"),0!==y.length)?(x.transition(0),void(S=!0)):void(x=void 0)},t.onSlideGestureChange=function(o){x&&0!==x.length&&(C=o.scale*T,C>t.params.maxZoom&&(C=t.params.maxZoom-1+Math.pow(C-t.params.maxZoom+1,.5)),C<t.params.minZoom&&(C=t.params.minZoom+1-Math.pow(t.params.minZoom-C+1,.5)),x.transform("translate3d(0,0,0) scale("+C+")"))},t.onSlideGestureEnd=function(){x&&0!==x.length&&(C=Math.max(Math.min(C,t.params.maxZoom),t.params.minZoom),x.transition(t.params.speed).transform("translate3d(0,0,0) scale("+C+")"),T=C,S=!1,1===C&&(b=void 0))},t.toggleZoom=function(){b||(b=t.swiper.slides.eq(t.swiper.activeIndex),x=b.find("img, svg, canvas"),y=x.parent(".photo-browser-zoom-container")),x&&0!==x.length&&(y.transition(300).transform("translate3d(0,0,0)"),C&&1!==C?(C=T=1,x.transition(300).transform("translate3d(0,0,0) scale(1)"),b=void 0):(C=T=t.params.maxZoom,x.transition(300).transform("translate3d(0,0,0) scale("+C+")")))};var I,M,z,B,E,L,P,k,Z,D,O,R,Y,G,H,q,N,X={},j={};t.onSlideTouchStart=function(e){x&&0!==x.length&&(I||("android"===o.device.os&&e.preventDefault(),I=!0,X.x="touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,X.y="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY))},t.onSlideTouchMove=function(e){if(x&&0!==x.length&&(t.swiper.allowClick=!1,I&&b)){M||(Z=x[0].offsetWidth,D=x[0].offsetHeight,O=o.getTranslate(y[0],"x")||0,R=o.getTranslate(y[0],"y")||0,y.transition(0));var a=Z*C,n=D*C;if(!(a<t.swiper.width&&n<t.swiper.height)){if(E=Math.min(t.swiper.width/2-a/2,0),P=-E,L=Math.min(t.swiper.height/2-n/2,0),k=-L,j.x="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,j.y="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,!M&&!S&&(Math.floor(E)===Math.floor(O)&&j.x<X.x||Math.floor(P)===Math.floor(O)&&j.x>X.x))return void(I=!1);e.preventDefault(),e.stopPropagation(),M=!0,z=j.x-X.x+O,B=j.y-X.y+R,E>z&&(z=E+1-Math.pow(E-z+1,.8)),z>P&&(z=P-1+Math.pow(z-P+1,.8)),L>B&&(B=L+1-Math.pow(L-B+1,.8)),B>k&&(B=k-1+Math.pow(B-k+1,.8)),Y||(Y=j.x),q||(q=j.y),G||(G=Date.now()),H=(j.x-Y)/(Date.now()-G)/2,N=(j.y-q)/(Date.now()-G)/2,Math.abs(j.x-Y)<2&&(H=0),Math.abs(j.y-q)<2&&(N=0),Y=j.x,q=j.y,G=Date.now(),y.transform("translate3d("+z+"px, "+B+"px,0)")}}},t.onSlideTouchEnd=function(){if(x&&0!==x.length){if(!I||!M)return I=!1,void(M=!1);I=!1,M=!1;var o=300,e=300,a=H*o,n=z+a,r=N*e,s=B+r;0!==H&&(o=Math.abs((n-z)/H)),0!==N&&(e=Math.abs((s-B)/N));var i=Math.max(o,e);z=n,B=s;var p=Z*C,l=D*C;E=Math.min(t.swiper.width/2-p/2,0),P=-E,L=Math.min(t.swiper.height/2-l/2,0),k=-L,z=Math.max(Math.min(z,P),E),B=Math.max(Math.min(B,k),L),y.transition(i).transform("translate3d("+z+"px, "+B+"px,0)")}};var W,V,$,A,F,J=!1,K=!0,Q=!1;return t.swipeCloseTouchStart=function(){K&&(J=!0)},t.swipeCloseTouchMove=function(o,e){if(J){Q||(Q=!0,V="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,A=t.swiper.slides.eq(t.swiper.activeIndex),F=(new Date).getTime()),e.preventDefault(),$="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,W=V-$;var a=1-Math.abs(W)/300;A.transform("translate3d(0,"+-W+"px,0)"),t.swiper.container.css("opacity",a).transition(0)}},t.swipeCloseTouchEnd=function(){if(J=!1,!Q)return void(Q=!1);Q=!1,K=!1;var e=Math.abs(W),a=(new Date).getTime()-F;return 300>a&&e>20||a>=300&&e>100?void setTimeout(function(){"standalone"===t.params.type&&t.close(),"popup"===t.params.type&&o.closeModal(t.popup),t.params.onSwipeToClose&&t.params.onSwipeToClose(t),K=!0},0):(0!==e?A.addClass("transitioning").transitionEnd(function(){K=!0,A.removeClass("transitioning")}):K=!0,t.swiper.container.css("opacity","").transition(""),void A.transform(""))},t};e.prototype={defaults:{photos:[],container:"body",initialSlide:0,spaceBetween:20,speed:300,zoom:!0,maxZoom:3,minZoom:1,exposition:!0,expositionHideCaptions:!1,type:"standalone",navbar:!0,toolbar:!0,theme:"light",swipeToClose:!0,backLinkText:"Close",ofText:"of",loop:!1,lazyLoading:!1,lazyLoadingInPrevNext:!1,lazyLoadingOnTransitionStart:!1}},o.photoBrowser=function(a){return o.extend(a,o.photoBrowser.prototype.defaults),new e(a)},o.photoBrowser.prototype={defaults:{}}}($);