!function(e,i){function t(e,i){var t=!1,n=!0,a=e.document,o=a.documentElement,d=a.addEventListener?"addEventListener":"attachEvent",r=a.addEventListener?"removeEventListener":"detachEvent",g=a.addEventListener?"":"on",l=function(n){("readystatechange"!=n.type||"complete"==a.readyState)&&(("load"==n.type?e:a)[r](g+n.type,l,!1),!t&&(t=!0)&&i.call(e,n.type||n))},c=function(){try{o.doScroll("left")}catch(e){return void setTimeout(c,50)}l("poll")};if("complete"==a.readyState)i.call(e,"lazy");else{if(a.createEventObject&&o.doScroll){try{n=!e.frameElement}catch(s){}n&&c()}a[d](g+"DOMContentLoaded",l,!1),a[d](g+"readystatechange",l,!1),e[d](g+"load",l,!1)}}WeixinJS="undefined"==typeof WeixinJS?{}:WeixinJS,WeixinJS.contentLoaded=t,WeixinJS.cfg={appId:""},window.videoMetaData=WeixinJS.videoMetaData={};var n=function(){for(var e=document.getElementsByTagName("meta"),i={},t=0;t<e.length;t++){var n=e[t].getAttribute("name"),a=e[t].getAttribute("property"),o=e[t].getAttribute("content")||"";(null==n||void 0==n||0==n.length)&&(n=a),null!=n&&void 0!=n&&0!=n.length&&(i[n]=o)}return window.videoMetaData=WeixinJS.videoMetaData=i,i};WeixinJS.UA=window.navigator.userAgent,WeixinJS.getVideoMetaData=window.getVideoMetaData=n,WeixinJS.IsWeixin=!(!window.WeixinJSBridge&&!/MicroMessenger/i.test(WeixinJS.UA)),WeixinJS.IsAndroid=!(!/Android|HTC|Adr/i.test(WeixinJS.UA)&&!(window.navigator.platform+"").match(/Linux/i)),WeixinJS.IsIpad=!WeixinJS.IsAndroid&&/iPad/i.test(WeixinJS.UA),WeixinJS.IsIpod=!WeixinJS.IsAndroid&&/iPod/i.test(WeixinJS.UA),WeixinJS.IsIphone=!WeixinJS.IsAndroid&&/iPod|iPhone/i.test(WeixinJS.UA),WeixinJS.IsIOS=WeixinJS.IsIpad||WeixinJS.IsIphone,WeixinJS.dataForWeixin={},WeixinJS.getData=function(e){return e=e||{},videoMetaData=WeixinJS.getVideoMetaData(),WeixinJS.dataForWeixin={appId:WeixinJS.cfg.appId,MsgImg:e.image||videoMetaData["og:image"]||"http://css.tv.itc.cn/global/images/nav1/logo.gif",TLImg:e.image||videoMetaData["og:image"]||"http://css.tv.itc.cn/global/images/nav1/logo.gif",url:e.url||videoMetaData["og:url"]||encodeURIComponent(window.location.href),imgWidth:e.width||videoMetaData["og:imgWidth"]||"300",imgHeight:e.height||videoMetaData["og:imgHeight"]||"300",title:e.title||videoMetaData["og:title"]||document.getElementsByTagName("title")[0].text.split(" ")[0]||"",desc:e.description||e.content||videoMetaData.description||document.getElementsByTagName("title")[0].text.split(" ")[0]||"",type:e.type||videoMetaData["og:type"]||"",callback:e.callback||function(){}},WeixinJS.dataForWeixin},WeixinJS.onJSBridgeReady=function(e){var i=WeixinJS.getData(e);if("undefined"!=typeof i){var t=i.title.substr(0,22);if(t.indexOf("搜狐视频")>-1||(t+="-搜狐视频",i.title=t),WeixinJS.IsWeixin&&/tv\.sohu\.com/i.test(i.url))try{var n=i.url;n=n.replace(/http:\/\/tv\.sohu\.com/i,"http://wx.m.tv.sohu.com"),n=n.replace(/http:\/\/my\.tv\.sohu\.com/i,"http://wx.m.tv.sohu.com"),i.url=n}catch(a){}WeixinJSBridge.on("menu:share:appmessage",function(e){WeixinJSBridge.invoke("sendAppMessage",{appid:i.appId,img_url:i.MsgImg,img_width:i.imgWidth,img_height:i.imgHeight,link:i.url,desc:i.desc,title:i.title},function(e){"send_app_msg:ok"==e.err_msg&&console.log(e.err_msg),i.callback()})}),WeixinJSBridge.on("menu:share:timeline",function(e){i.callback(),WeixinJSBridge.invoke("shareTimeline",{img_url:i.TLImg,img_width:i.imgWidth,img_height:i.imgHeight,link:i.url,desc:i.desc,title:i.title},function(e){"share_timeline:ok"==e.err_msg&&console.log(e.err_msg)})}),WeixinJSBridge.on("menu:general:share",function(e){var t="#分享视频#"+i.title;WeixinJS.IsIOS&&(t+=i.url,i.desc=i.desc.substr(0,29));var n={content:t,title:i.title,desc:i.desc,img_url:i.TLImg,img_width:i.imgWidth,img_height:i.imgHeight,link:i.url,data_url:i.url};i&&i.type&&(n.type=i.type),console.log("menu:general:share",n),e.generalShare(n,function(e){WeixinJSBridge.log(e.err_msg)})})}},WeixinJS.init=function(e){WeixinJS.IsWeixin&&("undefined"!=typeof WeixinJS.onJSBridgeReady?WeixinJS.onJSBridgeReady(e):setTimeout(function(){WeixinJS.init(e)},300))},WeixinJS.contentLoaded(e,function(){var e=WeixinJS.getData();WeixinJS.init(e)}),WeixinJS.chkJSB=function(e){WeixinJS.contentLoaded(window,function(){var i=WeixinJS.getData(e);WeixinJS.init(i)})},window.WeixinJS=WeixinJS,"function"==typeof define&&define("base/weixin",function(require,exports,module){module.exports=WeixinJS})}(window,document);